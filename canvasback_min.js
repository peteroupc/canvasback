function t(a){function b(){a();w(b)}a();w(b)}function x(a){return a&&"compileShader"in a}function w(a){var b=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;b?b(a):window.setTimeout(a,17)}
function y(a,b,c){var f=z.D,e=a.createBuffer(),d=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,e);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,d);a.bufferData(a.ARRAY_BUFFER,new Float32Array(b),a.STATIC_DRAW);var g=a.UNSIGNED_SHORT;65536<=b.length||65536<=c.length?(g=a.UNSIGNED_INT,a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint32Array(c),a.STATIC_DRAW)):a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(c),a.STATIC_DRAW);return{T:e,J:d,K:c.length,type:g,format:f}}
function A(a,b){for(var c=0;c<a.length;c+=8)a[c+3]=0,a[c+4]=0,a[c+5]=0;for(c=0;c<a.length;c+=3){var f=8*b[c],e=8*b[c+1],d=8*b[c+2],g=[a[e]-a[d],a[e+1]-a[d+1],a[e+2]-a[d+2]],h=[a[f]-a[d],a[f+1]-a[d+1],a[f+2]-a[d+2]],k=g[1]*h[2]-g[2]*h[1],l=g[2]*h[0]-g[0]*h[2],h=g[0]*h[1]-g[1]*h[0];len=Math.sqrt(k*k+l*l+h*h);0!=len&&(len=1/len,g[0]=k*len,g[1]=l*len,g[2]=h*len,a[f+3]+=g[0],a[f+4]+=g[1],a[f+5]+=g[2],a[e+3]+=g[0],a[e+4]+=g[1],a[e+5]+=g[2],a[d+3]+=g[0],a[d+4]+=g[1],a[d+5]+=g[2])}for(c=0;c<a.length;c+=8)if(k=
a[c+3],l=a[c+4],h=a[c+5],len=Math.sqrt(k*k+l*l+h*h))len=1/len,a[c+3]*=len,a[c+4]*=len,a[c+5]*=len}
function B(a){var b,c;function f(c,a,b){var f=C([(c[a]+c[b])/2,(c[a+1]+c[b+1])/2,(c[a+2]+c[b+2])/2]);c.push(f[0],f[1],f[2],0,0,0,(c[a+6]+c[b+6])/2,(c[a+7]+c[b+7])/2)}"undefined"==typeof b&&(b=1);"undefined"==typeof div&&(c=5);for(var e=[.5773502691896258,.5773502691896258,.5773502691896258,0,0,0,0,0,-.5773502691896258,-.5773502691896258,.5773502691896258,0,0,0,0,0,-.5773502691896258,.5773502691896258,-.5773502691896258,0,0,0,0,0,.5773502691896258,-.5773502691896258,-.5773502691896258,0,0,0,0,0],d=
[0,1,3,0,2,1,3,2,0,2,3,1],g=0;g<c;g++)for(var h=d.length,k=0;k<h;k+=3){var l=d[k],m=d[k+1],u=d[k+2],p=8*d[k],q=8*d[k+1],r=8*d[k+2],n=e.length/8;f(e,p,q);f(e,q,r);f(e,r,p);d[k]=n;d[k+1]=n+1;d[k+2]=n+2;d.push(l,n,n+2,m,n+1,n,u,n+2,n+1)}if(1!=b)for(g=0;g<e.length;g++)e[g]*=b;A(e,d);return y(a,e,d)}function C(a){var b=a[0],c=a[1],f=a[2];len=Math.sqrt(b*b+c*c+f*f);0!=len&&(len=1/len,a[0]*=len,a[1]*=len,a[2]*=len);return a}function D(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}
function E(a,b,c){null==b&&(b="attribute vec3 position;\nattribute vec3 normal;\nattribute vec2 textureUV;\nuniform mat4 world;\nuniform mat4 view;\nuniform mat4 projection;\nuniform float alpha;\nvarying vec2 textureUVVar;\nvarying vec3 normalVar;\nvarying vec3 viewPositionVar;\nvoid main(){\nvec4 positionVec4=vec4(position,1.0);\nmat4 viewWorld=view*world;\ngl_Position=projection*viewWorld*positionVec4;\nviewPositionVar=vec3(viewWorld*positionVec4);\nnormalVar=normalize(vec3(world*vec4(normal,0.0)));\ntextureUVVar=textureUV;\n}");
null==c&&(c="precision highp float;\nuniform sampler2D sampler;\nuniform int useTexture;\nuniform vec3 sa;\nuniform vec3 sd;\nuniform vec3 ss;\nuniform vec3 sdir;\nuniform vec3 ma;\nuniform vec3 md;\nuniform vec3 ms;\nuniform float mshin;\nuniform vec4 color;\nvarying vec3 normalVar;\nvarying vec3 viewPositionVar;\nvarying vec2 textureUVVar;\nvoid main(){\n vec3 normNormalVar=normalize(normalVar); vec3 normSdir=normalize(sdir); float diffInt=dot(normNormalVar,normSdir); vec4 baseColor=(useTexture==0) ? color : texture2D(sampler,textureUVVar);\n vec3 phong=(sa*ma)+(sd*md*baseColor.rgb*max(diffInt,0.0));\n if(diffInt>=0.0){\n   phong=phong+(ss*ms*pow(max(dot(reflect(-normSdir,normNormalVar),viewPositionVar),0.0),mshin));\n }\n gl_FragColor=vec4(phong,baseColor.a);\n}");
this.c=F(a,b,c);this.attributes={};this.a=a;this.m={};this.A={};if(null!=this.c){this.attributes=[];var f=null;b={};c=a.getProgramParameter(this.c,a.ACTIVE_ATTRIBUTES);for(var e=0;e<c;++e)if(f=a.getActiveAttrib(this.c,e),null!==f){var f=f.name,d=a.getAttribLocation(this.c,f);0<=d&&(this.attributes.push(d),b[f]=d)}c=a.getProgramParameter(this.c,a.ACTIVE_UNIFORMS);for(e=0;e<c;++e)d=a.getActiveUniform(this.c,e),null!==d&&(f=d.name,b[f]=a.getUniformLocation(this.c,f),this.A[f]=d.type);this.m=b}}
E.prototype.get=function(a){return this.m.hasOwnProperty(a)?this.m[a]:null};function G(a,b){for(var c in b)b.hasOwnProperty(c)&&(v=b[c],3==v.length?a.a.uniform3f(a.get(c),v[0],v[1],v[2]):16==v.length?a.a.uniformMatrix4fv(a.get(c),!1,v):a.A[c]==a.a.FLOAT?a.a.uniform1f(a.get(c),"number"==typeof v?v:v[0]):a.a.uniform1i(a.get(c),"number"==typeof v?v:v[0]))}
function F(a,b,c){function f(c,a,b){var f=c.createShader(a);c.shaderSource(f,b);c.compileShader(f);return c.getShaderParameter(f,c.COMPILE_STATUS)?f:(console.log((a==c.VERTEX_SHADER?"vertex: ":"fragment: ")+c.getShaderInfoLog(f)),null)}b=b&&0!=b.length?f(a,a.VERTEX_SHADER,b):null;c=c&&0!=c.length?f(a,a.FRAGMENT_SHADER,c):null;var e=null;null!==b&&null!==c&&(e=a.createProgram(),a.attachShader(e,b),a.attachShader(e,c),a.linkProgram(e),a.getProgramParameter(e,a.LINK_STATUS)?a.useProgram(e):(console.log("link: "+
a.getProgramInfoLog(e)),a.deleteProgram(e),e=null));null!==b&&a.deleteShader(b);null!==c&&a.deleteShader(c);return e}E.prototype.k=function(a){if(!a)return this;G(this,{sdir:a.direction,sa:a.n,sd:a.p,ss:a.u});return this};function H(a,b){b&&G(a,{mshin:b.R,ma:b.n,md:b.p,ms:b.u})}function I(a,b,c){this.R=null==c?1:Math.max(1,c);this.n=a||[0,0,0];this.p=b||[1,1,1];this.u=a||[.2,.2,.2]}function J(a,b,c){this.direction=a||[0,0,-1];this.n=b||[1,1,1];this.p=c||[.2,.2,.2];this.u=b||[.2,.2,.2]}
(function(){function a(c,a){this.kind=b.C;this.g=null;this.color=[a[0],a[1],a[2],null==a[3]?1:a[3]];this.a=c}function b(c,a){this.a=c;a.get("color");this.P=a.get("sampler");a.get("useTexture");this.a.uniform1i(this.P,0)}b.C=0;b.TEXTURE=1;b.prototype.q=function(c,b,e){return"number"==typeof c&&"number"==typeof b&&"number"==typeof e?new a(this.a,[c,b,e]):new a(this.a,c)};a.prototype.Q=function(c){this.g=c;return this};a.prototype.bind=function(c){var a=c.get("useTexture");null!==a&&this.a.uniform1i(a,
0);this.a.uniform4f(c.get("color"),this.color[0],this.color[1],this.color[2],this.color[3]);H(c,this.g)};window.Materials=b})(window);
function K(a){this.a=a;this.a.viewport(0,0,1*this.a.canvas.width,1*this.a.canvas.height);this.c=new E(a);this.h=[];this.clearColor=[0,0,0,0];this.N=new Materials(a,this.c);this.a.enable(a.BLEND);this.a.blendFunc(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA);a=L(this,D());G(a.c,{view:D()});a.k(new J);H(this.c,new I);this.a.enable(this.a.DEPTH_TEST);this.a.depthFunc(this.a.LEQUAL);this.a.clearColor(0,0,0,1);this.a.clearDepth(999999);this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT)}
K.prototype.q=function(a,b,c,f){return this.N.q(a,b,c,f)};function L(a,b){G(a.c,{projection:b});return a}K.prototype.k=function(a){this.c.k(a);return this};K.prototype.t=function(){this.a.clear(this.a.COLOR_BUFFER_BIT);for(var a=0;a<this.h.length;a++)this.h[a].t(this.c);this.a.flush()};function z(a,b){this.v=b;this.a=a;this.g=null;this.scale=[1,1,1];this.e=0;this.position=[0,0,0];this.B=[0,0,0];this.f=!1;this.d=D()}
function M(a,b,c,f,e,d){null!==b&&(a.enableVertexAttribArray(b),a.vertexAttribPointer(b,c,f,!1,e,d))}z.prototype.rotate=function(a){this.e+=a;this.e%=360;this.f=!0;return this};
z.prototype.t=function(a){var b=this.a,c=this.v,f=a.get("position"),e=a.get("normal"),d=a.get("textureUV");b.bindBuffer(b.ARRAY_BUFFER,c.T);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,c.J);c=c.format;5==c?(M(b,f,3,b.FLOAT,24,0),M(b,e,3,b.FLOAT,24,12)):c==z.D?(M(b,f,3,b.FLOAT,32,0),M(b,e,3,b.FLOAT,32,12),M(b,d,2,b.FLOAT,32,24)):2==c?M(b,f,2,b.FLOAT,8,0):3==c&&M(b,f,3,b.FLOAT,12,0);this.g&&this.g.bind(a);a=a.get("world");if(null!==a){if(this.f){this.f=!1;b=this.scale;this.d=[b[0],0,0,0,0,b[1],0,0,0,0,b[2],
0,0,0,0,1];if(0!=this.e){b=this.d;d=this.e;f=this.B;f=[f[0],f[1],f[2]];C(f);var d=d*Math.PI/180,e=Math.cos(d),g=Math.sin(d),c=1-e,h=f[0]*c,d=f[1]*c,c=f[2]*c,k=f[0]*g,l=f[1]*g,m=f[2]*g,g=f[0]*h+e,u=f[0]*d-m,p=f[0]*c+l,m=f[1]*h+m,q=f[1]*d+e,r=f[1]*c-k,h=f[2]*h-l,d=f[2]*d+k,f=f[2]*c+e;this.d=[b[0]*g+b[4]*u+b[8]*p,b[1]*g+b[5]*u+b[9]*p,b[2]*g+b[6]*u+b[10]*p,b[3]*g+b[7]*u+b[11]*p,b[0]*m+b[4]*q+b[8]*r,b[1]*m+b[5]*q+b[9]*r,b[2]*m+b[6]*q+b[10]*r,b[3]*m+b[7]*q+b[11]*r,b[0]*h+b[4]*d+b[8]*f,b[1]*h+b[5]*d+b[9]*
f,b[2]*h+b[6]*d+b[10]*f,b[3]*h+b[7]*d+b[11]*f,b[12],b[13],b[14],b[15]]}this.d[12]+=this.position[0];this.d[13]+=this.position[1];this.d[14]+=this.position[2]}this.a.uniformMatrix4fv(a,!1,this.d)}this.a.drawElements(this.a.TRIANGLES,this.v.K,this.v.type,0)};
(function(a){function b(c){c=c||"#ff0000";this.height=this.width=1E3;var a=$("<canvas>").attr("width",this.width+"").attr("height",this.height+"").css({width:"100%",height:"100%",left:"0px",zIndex:-1,top:"0px",position:"fixed"});$("body").append(a);this.l=!0;this.count=0;if(a=a.get(0)){var b=null,d={antialias:!0};try{b=a.getContext("webgl",d)}catch(g){b=null}if(!b)try{b=a.getContext("experimental-webgl",d)}catch(h){b=null}if(!b)try{b=a.getContext("moz-webgl",d)}catch(k){b=null}if(!b)try{b=a.getContext("webkit-3d",
d)}catch(l){b=null}if(!b)try{b=a.getContext("2d",d)}catch(m){b=null}x(b)&&(b.getExtension("OES_element_index_uint"),b.getExtension("EXT_texture_filter_anisotropic"));a=b}else a=null;this.a=a;this.l=x(this.a);this.h=[];this.setColor(c)}b.S=function(a){var f=a[0]-7.5+b.b(15);360<=f?f=360-f:0>f&&(f=360+f);var e=a[1],e=15>=e?b.b(30):240<e?240+b.b(30):e-15+b.b(30),d=a=a[2],d=15>=d?b.b(30):240<d?240+b.b(30):d+b.b(30);0<a&&0<e&&255>e&&(25>=e&&(e=25),242<=e&&(e=242));return[f,e,d]};b.b=function(a){return Math.random()*
a|0};b.O=function(a){var b=a[0],e=a[1];a=a[2];var d=b;e>d&&(d=e);a>d&&(d=a);var g=b;e<g&&(g=e);a<g&&(g=a);var h=d+g,k=h/2;if(d===g)return[0,0>k?0:255<k?255:k,0];var g=d-g,h=255*g/(127.5>=k?h:510-h),l=0,l=g/2,l=b===d?(60*(d-a)+l)/g-(60*(d-e)+l)/g:a===d?240+(60*(d-e)+l)/g-(60*(d-b)+l)/g:120+(60*(d-b)+l)/g-(60*(d-a)+l)/g;if(0>l||360<=l)l=(l%360+360)%360;return[l,0>k?0:255<k?255:k,0>h?0:255<h?255:h]};b.s=function(a){var b=1*a[0],e=1*a[1],d=1*a[2],e=0>e?0:255<e?255:e,d=0>d?0:255<d?255:d;if(0===d)return[e,
e,e];a=0;127.5>=e?a=e*(255+d)/255:(a=e*d/255,a=e+d-a);var g=2*e-a;if(0>b||360<=b)b=(b%360+360)%360;var h=b+120;360<=h&&(h-=360);e=60>h?g+(a-g)*h/60:180>h?a:240>h?g+(a-g)*(240-h)/60:g;h=b;d=60>h?g+(a-g)*h/60:180>h?a:240>h?g+(a-g)*(240-h)/60:g;h=b-120;0>h&&(h+=360);b=60>h?g+(a-g)*h/60:180>h?a:240>h?g+(a-g)*(240-h)/60:g;return[0>e?0:255<e?255:e,0>d?0:255<d?255:d,0>b?0:255<b?255:b]};b.o=function(a){a="0"+(a|0).toString(16);return a.substring(a.length-2,a.length)};b.r=function(a){a=b.s(a);return"#"+b.o(a[0])+
b.o(a[1])+b.o(a[2])};b.L=function(a){return null==a||"undefined"==typeof a?null:(a=/^\#([A-F0-9]{2})([A-F0-9]{2})([A-F0-9]{2})$/i.exec(a))?[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]:null};b.prototype.start=function(){t(this.F.bind(this))};b.prototype.setColor=function(a){a=this.constructor.L(a);if(!a)throw Error("invalid color parameter");this.color=a;this.i=this.constructor.O(a);this.H()};b.prototype.H=function(){document.body.style.backgroundColor=this.constructor.r(this.i);if(this.l){var a=
this.constructor.s(this.i),b=new J([0,0,-1],[.2,.2,.2],[1,1,1]);this.M=new I([1,1,1],[1,1,1],0);this.G=y(this.a,[-1,-1,1,1,0,0,1,1,-1,1,1,1,0,0,1,0,-1,1,-1,1,0,0,0,0,-1,-1,-1,1,0,0,0,1,1,-1,-1,-1,0,0,1,1,1,1,-1,-1,0,0,1,0,1,1,1,-1,0,0,0,0,1,-1,1,-1,0,0,0,1,1,-1,-1,0,1,0,1,1,1,-1,1,0,1,0,1,0,-1,-1,1,0,1,0,0,0,-1,-1,-1,0,1,0,0,1,1,1,1,0,-1,0,1,1,1,1,-1,0,-1,0,1,0,-1,1,-1,0,-1,0,0,0,-1,1,1,0,-1,0,0,1,-1,-1,-1,0,0,1,1,1,-1,1,-1,0,0,1,1,0,1,1,-1,0,0,1,0,0,1,-1,-1,0,0,1,0,1,1,-1,1,0,0,-1,1,1,1,1,1,0,0,
-1,1,0,-1,1,1,0,0,-1,0,0,-1,-1,1,0,0,-1,0,1],[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]);this.w=B(this.a);b=L(new K(this.a),[-1,0,0,0,0,1,0,0,0,0,-.2,0,-0,0,0,1]).k(b);b.a.clearColor(a[0]/255,a[1]/255,a[2]/255,1);this.j=b}else this.a.fillStyle=this.constructor.r(this.i),this.a.fillRect(0,0,this.width,this.height)};b.prototype.F=function(){this.count++;4<=this.count&&(this.count=0,this.I());this.l&&this.j.t()};b.prototype.I=function(){var a=this.constructor.S(this.i);
if(this.l){300<this.h.length&&this.j.h.shift();var b=this.constructor.b(2E3)/1E3-1,e=this.constructor.b(2E3)/1E3-1,d=this.constructor.b(60)/60,g=0==this.constructor.b(2)?this.G:this.w,h=(16+this.constructor.b(100))/1E3,k=this.constructor.s(a);k[0]/=255;k[1]/=255;k[2]/=255;var l=this.constructor.b(160),m=[this.constructor.b(60)/30,this.constructor.b(60)/30,this.constructor.b(60)/30],a=new z(this.a,g);a.scale=[h,h,h];a.f=!0;g!=this.w&&(a.e=l%360,a.B=m,a.f=!0);a.position=[b,e,d];a.f=!0;b=this.j.q(k).Q(this.M);
a.g=b;this.j.h.push(a)}else b=[this.constructor.b(this.width+30)-30,this.constructor.b(this.height+30)-30,32+this.constructor.b(200),32+this.constructor.b(200)],this.a.fillStyle=this.constructor.r(a),this.a.fillRect(b[0],b[1],b[2],b[3])};b.colorBackground=function(a){$(document).ready(function(){(new b(a)).start()})};a.CanvasBackground=b})(this);
