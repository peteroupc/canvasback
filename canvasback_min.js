function w(a){function b(){a();x(b)}a();x(b)}function y(a){return a&&"compileShader"in a}function x(a){var b=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;b?b(a):window.setTimeout(a,17)}
function z(a,b,c){var h=A.D,g=a.createBuffer(),d=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,g);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,d);a.bufferData(a.ARRAY_BUFFER,new Float32Array(b),a.STATIC_DRAW);var f=a.UNSIGNED_SHORT;65536<=b.length||65536<=c.length?(f=a.UNSIGNED_INT,a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint32Array(c),a.STATIC_DRAW)):256>=b.length&&256>=c.length?(f=a.UNSIGNED_BYTE,a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint8Array(c),a.STATIC_DRAW)):a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(c),
a.STATIC_DRAW);return{T:g,J:d,K:c.length,type:f,format:h}}
function B(a,b){for(var c=0;c<a.length;c+=8)a[c+3]=0,a[c+4]=0,a[c+5]=0;for(c=0;c<a.length;c+=3){var h=8*b[c],g=8*b[c+1],d=8*b[c+2],f=[a[g]-a[d],a[g+1]-a[d+1],a[g+2]-a[d+2]],e=[a[h]-a[d],a[h+1]-a[d+1],a[h+2]-a[d+2]],l=f[1]*e[2]-f[2]*e[1],k=f[2]*e[0]-f[0]*e[2],e=f[0]*e[1]-f[1]*e[0];len=Math.sqrt(l*l+k*k+e*e);0!=len&&(len=1/len,f[0]=l*len,f[1]=k*len,f[2]=e*len,a[h+3]+=f[0],a[h+4]+=f[1],a[h+5]+=f[2],a[g+3]+=f[0],a[g+4]+=f[1],a[g+5]+=f[2],a[d+3]+=f[0],a[d+4]+=f[1],a[d+5]+=f[2])}for(c=0;c<a.length;c+=8)if(l=
a[c+3],k=a[c+4],e=a[c+5],len=Math.sqrt(l*l+k*k+e*e))len=1/len,a[c+3]=l*len,a[c+4]=k*len,a[c+5]=e*len}
function C(a){var b,c;function h(c,a,b){a=D([(c[a]+c[b])/2,(c[a+1]+c[b+1])/2,(c[a+2]+c[b+2])/2]);c.push(a[0],a[1],a[2],0,0,0,0,0)}function g(c,a,b,d,h,g){var e,f=8*a[b+d],k=8*a[b+h],l=8*a[b+g];e=(c[k+6]+c[l+6])/2;if(.5<Math.abs(c[k+6]-c[l+6])){var m=(e=c[k+6]<c[l+6]?!0:!1)?k:l,n=c[m+6]+1;a[b+(e?h:g)]=c.length/8;c.push(c[m],c[m+1],c[m+2],0,0,0,n,c[m+7]);e=e?n+c[l+6]:n+c[k+6];e/=2}a[b+d]=c.length/8;c.push(c[f],c[f+1],c[f+2],0,0,0,e,c[f+7])}"undefined"==typeof b&&(b=1);"undefined"==typeof div&&(c=6);
for(var d=[.5773502691896258,.5773502691896258,.5773502691896258,0,0,0,0,0,-.5773502691896258,-.5773502691896258,.5773502691896258,0,0,0,0,0,-.5773502691896258,.5773502691896258,-.5773502691896258,0,0,0,0,0,.5773502691896258,-.5773502691896258,-.5773502691896258,0,0,0,0,0],f=[0,1,3,0,2,1,3,2,0,2,3,1],e=0;e<c;e++)for(var l=f.length,k=0;k<l;k+=3){var m=f[k],t=f[k+1],u=f[k+2],p=8*m,q=8*t,n=8*u,r=d.length/8;h(d,p,q);h(d,q,n);h(d,n,p);f[k]=r;f[k+1]=r+1;f[k+2]=r+2;f.push(m,r,r+2,t,r+1,r,u,r+2,r+1)}for(e=
0;e<d.length;e+=8)d[e+6]=1-(.5+Math.atan2(d[e],d[e+2])/(2*Math.PI)),d[e+7]=1-Math.acos(d[e+1])/Math.PI;for(k=0;k<f.length;k+=3)p=8*f[k],q=8*f[k+1],n=8*f[k+2],0==d[p]&&0==d[p+2]?g(d,f,k,0,1,2):0==d[q]&&0==d[q+2]?g(d,f,k,1,0,2):0==d[n]&&0==d[n+2]?g(d,f,k,2,0,1):(e=d[p+6],l=d[q+6],m=d[n+6],c=e<l?e<m?p:n:l<m?q:n,e=e>l?e>m?p:n:l>m?q:n,n=p==c||p==e?q==c||q==e?n:q:p,.5<d[e+6]-d[c+6]&&(l=d.length/8,d.push(d[c],d[c+1],d[c+2],0,0,0,d[c+6]+1,d[c+7]),p==c?f[k]=l:q==c?f[k+1]=l:f[k+2]=l,farEnd=8*l,.5<d[e+6]-d[n+
6]&&(l=d.length/8,d.push(d[n],d[n+1],d[n+2],0,0,0,d[n+6]+1,d[n+7]),p==n?f[k]=l:q==n?f[k+1]=l:f[k+2]=l,midEnd=8*l)));if(1!=b)for(e=0;e<d.length;e+=8)d[e]*=b,d[e+1]*=b,d[e+2]*=b;B(d,f);return z(a,d,f)}function D(a){var b=a[0],c=a[1],h=a[2];len=Math.sqrt(b*b+c*c+h*h);0!=len&&(len=1/len,a[0]*=len,a[1]*=len,a[2]*=len);return a}function E(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}
function F(a,b,c){null==b&&(b="attribute vec3 position;\nattribute vec3 normal;\nattribute vec2 textureUV;\nuniform mat4 world;\nuniform mat4 view;\nuniform mat4 projection;\nuniform float alpha;\nvarying vec2 textureUVVar;\nvarying vec3 normalVar;\nvarying vec3 viewPositionVar;\nvoid main(){\nvec4 positionVec4=vec4(position,1.0);\nmat4 viewWorld=view*world;\ngl_Position=projection*viewWorld*positionVec4;\nviewPositionVar=vec3(viewWorld*positionVec4);\nnormalVar=normalize(vec3(world*vec4(normal,0.0)));\ntextureUVVar=textureUV;\n}");null==
c&&(c="precision highp float;\nuniform sampler2D sampler;\nuniform int useTexture;\nuniform vec3 sa;\nuniform vec3 sd;\nuniform vec3 ss;\nuniform vec3 sdir;\nuniform vec3 ma;\nuniform vec3 md;\nuniform vec3 ms;\nuniform float mshin;\nuniform vec4 color;\nvarying vec3 normalVar;\nvarying vec3 viewPositionVar;\nvarying vec2 textureUVVar;\nvoid main(){\n vec3 normNormalVar=normalize(normalVar); vec3 normSdir=normalize(sdir); float diffInt=dot(normNormalVar,normSdir); vec4 baseColor=(useTexture==0) ? color : texture2D(sampler,textureUVVar);\n vec3 phong=(sa*ma)+(sd*md*baseColor.rgb*max(diffInt,0.0));\n if(diffInt>=0.0){\n   phong=phong+(ss*ms*pow(max(dot(reflect(-normSdir,normNormalVar),viewPositionVar),0.0),mshin));\n }\n gl_FragColor=vec4(phong,baseColor.a);\n}");
this.c=G(a,b,c);this.attributes={};this.a=a;this.m={};this.B={};if(null!=this.c){this.attributes=[];var h=null;b={};c=a.getProgramParameter(this.c,a.ACTIVE_ATTRIBUTES);for(var g=0;g<c;++g)if(h=a.getActiveAttrib(this.c,g),null!==h){var h=h.name,d=a.getAttribLocation(this.c,h);0<=d&&(this.attributes.push(d),b[h]=d)}c=a.getProgramParameter(this.c,a.ACTIVE_UNIFORMS);for(g=0;g<c;++g)d=a.getActiveUniform(this.c,g),null!==d&&(h=d.name,b[h]=a.getUniformLocation(this.c,h),this.B[h]=d.type);this.m=b}}
F.prototype.get=function(a){return this.m.hasOwnProperty(a)?this.m[a]:null};function H(a,b){for(var c in b)b.hasOwnProperty(c)&&(v=b[c],3==v.length?a.a.uniform3f(a.get(c),v[0],v[1],v[2]):16==v.length?a.a.uniformMatrix4fv(a.get(c),!1,v):a.B[c]==a.a.FLOAT?a.a.uniform1f(a.get(c),"number"==typeof v?v:v[0]):a.a.uniform1i(a.get(c),"number"==typeof v?v:v[0]))}
function G(a,b,c){function h(c,a,b){var h=c.createShader(a);c.shaderSource(h,b);c.compileShader(h);return c.getShaderParameter(h,c.COMPILE_STATUS)?h:(console.log((a==c.VERTEX_SHADER?"vertex: ":"fragment: ")+c.getShaderInfoLog(h)),null)}b=b&&0!=b.length?h(a,a.VERTEX_SHADER,b):null;c=c&&0!=c.length?h(a,a.FRAGMENT_SHADER,c):null;var g=null;null!==b&&null!==c&&(g=a.createProgram(),a.attachShader(g,b),a.attachShader(g,c),a.linkProgram(g),a.getProgramParameter(g,a.LINK_STATUS)?a.useProgram(g):(console.log("link: "+
a.getProgramInfoLog(g)),a.deleteProgram(g),g=null));null!==b&&a.deleteShader(b);null!==c&&a.deleteShader(c);return g}F.prototype.k=function(a){if(!a)return this;H(this,{sdir:a.direction,sa:a.n,sd:a.p,ss:a.u});return this};function I(a,b){b&&H(a,{mshin:b.R,ma:b.n,md:b.p,ms:b.u})}function J(a,b,c){this.R=null==c?1:Math.max(1,c);this.n=a||[0,0,0];this.p=b||[1,1,1];this.u=a||[.2,.2,.2]}function K(a,b,c){this.direction=a||[0,0,-1];this.n=b||[1,1,1];this.p=c||[.2,.2,.2];this.u=b||[.2,.2,.2]}
(function(){function a(c,a){this.kind=b.C;this.g=null;this.color=[a[0],a[1],a[2],null==a[3]?1:a[3]];this.a=c}function b(c,a){this.a=c;a.get("color");this.P=a.get("sampler");a.get("useTexture");this.a.uniform1i(this.P,0)}b.C=0;b.TEXTURE=1;b.prototype.q=function(c,b,g){return"number"==typeof c&&"number"==typeof b&&"number"==typeof g?new a(this.a,[c,b,g]):new a(this.a,c)};a.prototype.Q=function(c){this.g=c;return this};a.prototype.bind=function(c){var a=c.get("useTexture");null!==a&&this.a.uniform1i(a,
0);this.a.uniform4f(c.get("color"),this.color[0],this.color[1],this.color[2],this.color[3]);I(c,this.g)};window.Materials=b})(window);
function L(a){this.a=a;this.a.viewport(0,0,1*this.a.canvas.width,1*this.a.canvas.height);this.c=new F(a);this.h=[];this.clearColor=[0,0,0,0];this.N=new Materials(a,this.c);this.a.enable(a.BLEND);this.a.blendFunc(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA);a=M(this,E());H(a.c,{view:E()});a.k(new K);I(this.c,new J);this.a.enable(this.a.DEPTH_TEST);this.a.depthFunc(this.a.LEQUAL);this.a.clearColor(0,0,0,1);this.a.clearDepth(999999);this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT)}
L.prototype.q=function(a,b,c,h){return this.N.q(a,b,c,h)};function M(a,b){H(a.c,{projection:b});return a}L.prototype.k=function(a){this.c.k(a);return this};L.prototype.t=function(){this.a.clear(this.a.COLOR_BUFFER_BIT);for(var a=0;a<this.h.length;a++)this.h[a].t(this.c);this.a.flush()};function A(a,b){this.w=b;this.a=a;this.g=null;this.scale=[1,1,1];this.e=0;this.position=[0,0,0];this.v=[0,0,0];this.f=!1;this.d=E()}
function N(a,b,c,h,g,d){null!==b&&(a.enableVertexAttribArray(b),a.vertexAttribPointer(b,c,h,!1,g,d))}A.prototype.rotate=function(a,b){this.e+=a;this.e%=360;this.v=b;this.f=!0;return this};
A.prototype.t=function(a){var b=this.a,c=this.w,h=a.get("position"),g=a.get("normal"),d=a.get("textureUV");b.bindBuffer(b.ARRAY_BUFFER,c.T);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,c.J);c=c.format;5==c?(N(b,h,3,b.FLOAT,24,0),N(b,g,3,b.FLOAT,24,12)):c==A.D?(N(b,h,3,b.FLOAT,32,0),N(b,g,3,b.FLOAT,32,12),N(b,d,2,b.FLOAT,32,24)):2==c?N(b,h,2,b.FLOAT,8,0):3==c&&N(b,h,3,b.FLOAT,12,0);this.g&&this.g.bind(a);a=a.get("world");if(null!==a){if(this.f){this.f=!1;b=this.scale;this.d=[b[0],0,0,0,0,b[1],0,0,0,0,b[2],
0,0,0,0,1];if(0!=this.e){b=this.d;d=this.e;h=this.v;h=[h[0],h[1],h[2]];D(h);var d=d*Math.PI/180,g=Math.cos(d),f=Math.sin(d),c=1-g,e=h[0]*c,d=h[1]*c,c=h[2]*c,l=h[0]*f,k=h[1]*f,m=h[2]*f,f=h[0]*e+g,t=h[0]*d-m,u=h[0]*c+k,m=h[1]*e+m,p=h[1]*d+g,q=h[1]*c-l,e=h[2]*e-k,d=h[2]*d+l,h=h[2]*c+g;this.d=[b[0]*f+b[4]*t+b[8]*u,b[1]*f+b[5]*t+b[9]*u,b[2]*f+b[6]*t+b[10]*u,b[3]*f+b[7]*t+b[11]*u,b[0]*m+b[4]*p+b[8]*q,b[1]*m+b[5]*p+b[9]*q,b[2]*m+b[6]*p+b[10]*q,b[3]*m+b[7]*p+b[11]*q,b[0]*e+b[4]*d+b[8]*h,b[1]*e+b[5]*d+b[9]*
h,b[2]*e+b[6]*d+b[10]*h,b[3]*e+b[7]*d+b[11]*h,b[12],b[13],b[14],b[15]]}this.d[12]+=this.position[0];this.d[13]+=this.position[1];this.d[14]+=this.position[2]}this.a.uniformMatrix4fv(a,!1,this.d)}this.a.drawElements(this.a.TRIANGLES,this.w.K,this.w.type,0)};
(function(a){function b(c){c=c||"#ff0000";this.height=this.width=1E3;var a=$("<canvas>").attr("width",this.width+"").attr("height",this.height+"").css({width:"100%",height:"100%",left:"0px",zIndex:-1,top:"0px",position:"fixed"});$("body").append(a);this.l=!0;this.count=0;if(a=a.get(0)){var b=null,d={antialias:!0};try{b=a.getContext("webgl",d)}catch(f){b=null}if(!b)try{b=a.getContext("experimental-webgl",d)}catch(e){b=null}if(!b)try{b=a.getContext("moz-webgl",d)}catch(l){b=null}if(!b)try{b=a.getContext("webkit-3d",
d)}catch(k){b=null}if(!b)try{b=a.getContext("2d",d)}catch(m){b=null}y(b)&&(b.getExtension("OES_element_index_uint"),b.getExtension("EXT_texture_filter_anisotropic"));a=b}else a=null;this.a=a;this.l=y(this.a);this.h=[];this.setColor(c)}b.S=function(c){var a=c[0]-7.5+b.b(15);360<=a?a=360-a:0>a&&(a=360+a);var g=c[1],g=15>=g?b.b(30):240<g?240+b.b(30):g-15+b.b(30),d=c=c[2],d=15>=d?b.b(30):240<d?240+b.b(30):d+b.b(30);0<c&&0<g&&255>g&&(25>=g&&(g=25),242<=g&&(g=242));return[a,g,d]};b.b=function(a){return Math.random()*
a|0};b.O=function(a){var b=a[0],g=a[1];a=a[2];var d=b;g>d&&(d=g);a>d&&(d=a);var f=b;g<f&&(f=g);a<f&&(f=a);var e=d+f,l=e/2;if(d===f)return[0,0>l?0:255<l?255:l,0];var f=d-f,e=255*f/(127.5>=l?e:510-e),k=0,k=f/2,k=b===d?(60*(d-a)+k)/f-(60*(d-g)+k)/f:a===d?240+(60*(d-g)+k)/f-(60*(d-b)+k)/f:120+(60*(d-b)+k)/f-(60*(d-a)+k)/f;if(0>k||360<=k)k=(k%360+360)%360;return[k,0>l?0:255<l?255:l,0>e?0:255<e?255:e]};b.s=function(a){var b=1*a[0],g=1*a[1],d=1*a[2],g=0>g?0:255<g?255:g,d=0>d?0:255<d?255:d;if(0===d)return[g,
g,g];a=0;127.5>=g?a=g*(255+d)/255:(a=g*d/255,a=g+d-a);var f=2*g-a;if(0>b||360<=b)b=(b%360+360)%360;var e=b+120;360<=e&&(e-=360);g=60>e?f+(a-f)*e/60:180>e?a:240>e?f+(a-f)*(240-e)/60:f;e=b;d=60>e?f+(a-f)*e/60:180>e?a:240>e?f+(a-f)*(240-e)/60:f;e=b-120;0>e&&(e+=360);b=60>e?f+(a-f)*e/60:180>e?a:240>e?f+(a-f)*(240-e)/60:f;return[0>g?0:255<g?255:g,0>d?0:255<d?255:d,0>b?0:255<b?255:b]};b.o=function(a){a="0"+(a|0).toString(16);return a.substring(a.length-2,a.length)};b.r=function(a){a=b.s(a);return"#"+b.o(a[0])+
b.o(a[1])+b.o(a[2])};b.L=function(a){return null==a||"undefined"==typeof a?null:(a=/^\#([A-F0-9]{2})([A-F0-9]{2})([A-F0-9]{2})$/i.exec(a))?[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]:null};b.prototype.start=function(){w(this.F.bind(this))};b.prototype.setColor=function(a){a=this.constructor.L(a);if(!a)throw Error("invalid color parameter");this.color=a;this.i=this.constructor.O(a);this.H()};b.prototype.H=function(){document.body.style.backgroundColor=this.constructor.r(this.i);if(this.l){var a=
this.constructor.s(this.i),b=new K([0,0,-1],[.2,.2,.2],[1,1,1]);this.M=new J([1,1,1],[1,1,1],0);this.G=z(this.a,[-1,-1,1,1,0,0,1,1,-1,1,1,1,0,0,1,0,-1,1,-1,1,0,0,0,0,-1,-1,-1,1,0,0,0,1,1,-1,-1,-1,0,0,1,1,1,1,-1,-1,0,0,1,0,1,1,1,-1,0,0,0,0,1,-1,1,-1,0,0,0,1,1,-1,-1,0,1,0,1,1,1,-1,1,0,1,0,1,0,-1,-1,1,0,1,0,0,0,-1,-1,-1,0,1,0,0,1,1,1,1,0,-1,0,1,1,1,1,-1,0,-1,0,1,0,-1,1,-1,0,-1,0,0,0,-1,1,1,0,-1,0,0,1,-1,-1,-1,0,0,1,1,1,-1,1,-1,0,0,1,1,0,1,1,-1,0,0,1,0,0,1,-1,-1,0,0,1,0,1,1,-1,1,0,0,-1,1,1,1,1,1,0,0,
-1,1,0,-1,1,1,0,0,-1,0,0,-1,-1,1,0,0,-1,0,1],[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]);this.A=C(this.a);b=M(new L(this.a),[-1,0,0,0,0,1,0,0,0,0,-.2,0,-0,0,0,1]).k(b);b.a.clearColor(a[0]/255,a[1]/255,a[2]/255,1);this.j=b}else this.a.fillStyle=this.constructor.r(this.i),this.a.fillRect(0,0,this.width,this.height)};b.prototype.F=function(){this.count++;4<=this.count&&(this.count=0,this.I());this.l&&this.j.t()};b.prototype.I=function(){var a=this.constructor.S(this.i);
if(this.l){300<this.h.length&&this.j.h.shift();var b=this.constructor.b(2E3)/1E3-1,g=this.constructor.b(2E3)/1E3-1,d=this.constructor.b(60)/60,f=0==this.constructor.b(2)?this.G:this.A,e=(16+this.constructor.b(100))/1E3,l=this.constructor.s(a);l[0]/=255;l[1]/=255;l[2]/=255;var a=this.constructor.b(160),k=D([this.constructor.b(360)/360,this.constructor.b(360)/360,this.constructor.b(360)/360]),m=new A(this.a,f);m.scale=[e,e,e];m.f=!0;e=this.j.q(l).Q(this.M);if(f!=this.A||e.kind==Materials.TEXTURE)m.e=
a%360,m.v=k,m.f=!0;m.position=[b,g,d];m.f=!0;m.g=e;this.j.h.push(m)}else b=[this.constructor.b(this.width+30)-30,this.constructor.b(this.height+30)-30,32+this.constructor.b(200),32+this.constructor.b(200)],this.a.fillStyle=this.constructor.r(a),this.a.fillRect(b[0],b[1],b[2],b[3])};b.colorBackground=function(a){$(document).ready(function(){(new b(a)).start()})};a.CanvasBackground=b})(this);
